cmake_minimum_required(VERSION 3.15)

project(XiangQi LANGUAGES CXX RC)

# 设置 C++ 标准
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# 可执行文件名称
set(EXECUTABLE_NAME "XiangQi")

# ============================
# 路径设置
# ============================

# 源码和资源路径
set(SOURCE_DIR ${CMAKE_SOURCE_DIR}/code)
set(RESOURCE_FILE ${CMAKE_SOURCE_DIR}/resource.rc)

# SFML路径（你自己设置的 include/SFML）
set(SFML_INCLUDE_DIR ${CMAKE_SOURCE_DIR}/include/SFML/include)
set(SFML_LIB_DIR ${CMAKE_SOURCE_DIR}/include/SFML/lib)

# ============================
# 包含目录和库路径
# ============================
include_directories(${SFML_INCLUDE_DIR})
include_directories(${SOURCE_DIR})
link_directories(${SFML_LIB_DIR})

# ============================
# 源文件自动收集
# ============================
file(GLOB_RECURSE SOURCE_FILES ${SOURCE_DIR}/*.cpp)
file(GLOB_RECURSE HEADER_FILES ${SOURCE_DIR}/*.h)

# ============================
# 创建可执行文件
# ============================
add_executable(${EXECUTABLE_NAME}
    ${SOURCE_FILES}
    ${HEADER_FILES}
    ${RESOURCE_FILE}
)

# ============================
# 告诉 MSVC 使用 UTF-8 编码，避免 C4819 警告
# ============================
if(MSVC)
    target_compile_options(${EXECUTABLE_NAME} PRIVATE /utf-8)
endif()

# ============================
# 链接 SFML 库
# ============================
target_link_libraries(${EXECUTABLE_NAME}
    sfml-graphics
    sfml-window
    sfml-system
)

# ============================
# 固定输出目录到 /game
# ============================
set(OUTPUT_DIR ${CMAKE_SOURCE_DIR}/game)

set_target_properties(${EXECUTABLE_NAME} PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY ${OUTPUT_DIR}
    RUNTIME_OUTPUT_DIRECTORY_DEBUG ${OUTPUT_DIR}
    RUNTIME_OUTPUT_DIRECTORY_RELEASE ${OUTPUT_DIR}
)
